<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - EarlyBird</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: #f5f7fa;
            color: #333;
        }

        /* Header */
        header {
            background: white;
            padding: 20px 30px;
            border-bottom: 1px solid #e1e8ed;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .header-title h1 {
            font-size: 24px;
            font-weight: 600;
            color: #2c3e50;
        }

        .header-title p {
            font-size: 13px;
            color: #7f8c8d;
            margin-top: 2px;
        }

        .header-nav {
            display: flex;
            gap: 15px;
        }

        .nav-btn {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            font-size: 13px;
            transition: all 0.3s ease;
        }

        .nav-btn-primary {
            background: #27ae60;
            color: white;
        }

        .nav-btn-primary:hover {
            background: #229954;
        }

        .nav-btn-secondary {
            background: #e67e22;
            color: white;
        }

        .nav-btn-secondary:hover {
            background: #d35400;
        }

        .nav-btn-tertiary {
            background: #95a5a6;
            color: white;
        }

        .nav-btn-tertiary:hover {
            background: #7f8c8d;
        }

        /* Main Container */
        .container {
            padding: 30px;
            max-width: 1400px;
            margin: 0 auto;
        }

        /* Dashboard Date Section */
        .dashboard-header {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        .date-picker {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .date-picker input {
            padding: 10px 15px;
            border: 1px solid #bdc3c7;
            border-radius: 6px;
            font-size: 14px;
        }

        .date-picker button {
            padding: 10px 20px;
            background: #3498db;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
        }

        .date-display {
            color: #7f8c8d;
            font-size: 14px;
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            border-left: 4px solid #3498db;
        }

        .stat-card.customers {
            border-left-color: #3498db;
        }

        .stat-card.area {
            border-left-color: #27ae60;
        }

        .stat-card.delivery {
            border-left-color: #9b59b6;
        }

        .stat-card.marketing {
            border-left-color: #e74c3c;
        }

        .stat-card.nodata {
            border-left-color: #95a5a6;
        }

        .stat-icon {
            font-size: 24px;
            margin-bottom: 10px;
        }

        .stat-value {
            font-size: 28px;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 13px;
            color: #7f8c8d;
            margin-bottom: 8px;
        }

        .stat-detail {
            font-size: 12px;
            color: #95a5a6;
        }

        /* Detailed Stats Section */
        .detailed-stats {
            background: white;
            padding: 25px;
            border-radius: 8px;
            margin-bottom: 30px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        .section-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 20px;
            color: #2c3e50;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .filters-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
        }

        .filter-group label {
            font-size: 12px;
            font-weight: 600;
            margin-bottom: 6px;
            color: #2c3e50;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .filter-group input,
        .filter-group select {
            padding: 10px 12px;
            border: 1px solid #bdc3c7;
            border-radius: 6px;
            font-size: 13px;
            font-family: inherit;
        }

        .apply-filters-btn {
            background: #6c5ce7;
            color: white;
            border: none;
            padding: 10px 30px;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            align-self: flex-end;
            margin-top: 15px;
        }

        .apply-filters-btn:hover {
            background: #5f3dc4;
        }

        .no-filters-message {
            text-align: center;
            color: #95a5a6;
            padding: 40px 20px;
            font-size: 14px;
        }

        /* Tab Navigation */
        .tab-navigation {
            display: flex;
            gap: 0;
            border-bottom: 2px solid #e1e8ed;
            margin-bottom: 30px;
            background: white;
            padding: 0 20px;
            border-radius: 8px 8px 0 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            flex-wrap: wrap;
        }

        .tab {
            padding: 15px 20px;
            border: none;
            background: none;
            cursor: pointer;
            font-size: 13px;
            font-weight: 500;
            color: #7f8c8d;
            border-bottom: 3px solid transparent;
            white-space: nowrap;
            transition: all 0.3s ease;
            position: relative;
        }

        .tab:hover {
            color: #2c3e50;
        }

        .tab.active {
            color: #2c3e50;
            border-bottom-color: #3498db;
        }

        .tab-badge {
            background: #e74c3c;
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 11px;
            margin-left: 6px;
        }

        /* Content Area */
        .content-section {
            background: white;
            padding: 25px;
            border-radius: 0 0 8px 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        .content-section.hidden {
            display: none;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .export-btn {
            background: #3498db;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            font-size: 13px;
        }

        /* Table */
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 13px;
        }

        table thead {
            background: #f8f9fa;
            border-bottom: 2px solid #e1e8ed;
        }

        table th {
            padding: 12px;
            text-align: left;
            font-weight: 600;
            color: #2c3e50;
        }

        table td {
            padding: 12px;
            border-bottom: 1px solid #e1e8ed;
        }

        table tbody tr:hover {
            background: #f8f9fa;
        }

        /* Import Section */
        .import-container {
            max-width: 600px;
            margin: 0 auto;
        }

        .import-box {
            border: 2px dashed #3498db;
            border-radius: 8px;
            padding: 40px;
            text-align: center;
            background: #ecf0f1;
        }

        .import-box input[type="file"] {
            display: none;
        }

        .import-label {
            cursor: pointer;
            display: inline-block;
        }

        .import-button {
            background: #3498db;
            color: white;
            padding: 12px 30px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            margin-top: 15px;
        }

        .import-button:hover {
            background: #2980b9;
        }

        /* Status Messages */
        .status-message {
            padding: 15px;
            border-radius: 6px;
            margin: 15px 0;
            font-size: 13px;
        }

        .status-success {
            background: #d5f4e6;
            color: #27ae60;
            border: 1px solid #27ae60;
        }

        .status-error {
            background: #fadbd8;
            color: #e74c3c;
            border: 1px solid #e74c3c;
        }

        .status-info {
            background: #d6eaf8;
            color: #3498db;
            border: 1px solid #3498db;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .filters-row {
                grid-template-columns: 1fr;
            }

            .tab-navigation {
                overflow-x: auto;
            }

            header {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }

            .dashboard-header {
                flex-direction: column;
                gap: 15px;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="header-left">
            <div class="header-title">
                <h1>üì¶ Admin Dashboard</h1>
                <p>Complete Phase-0 System</p>
            </div>
        </div>
        <div class="header-nav">
            <button class="nav-btn nav-btn-primary">üìä Monthly Billing</button>
            <button class="nav-btn nav-btn-secondary">üí∞ Commission</button>
            <button class="nav-btn nav-btn-tertiary">‚öôÔ∏è Settings</button>
            <button class="nav-btn nav-btn-tertiary">üö™ Logout</button>
        </div>
    </header>

    <!-- Main Container -->
    <div class="container">
        <!-- Dashboard Header with Date -->
        <div class="dashboard-header">
            <div class="date-picker">
                <label>üìÖ Dashboard Date:</label>
                <input type="date" id="dashboardDate" value="2026-01-23">
                <button onclick="setToday()">Today</button>
            </div>
            <div class="date-display" id="dateDisplay">Showing data for: Fri, 23 Jan, 2026</div>
        </div>

        <!-- Stats Grid -->
        <div class="stats-grid">
            <div class="stat-card customers">
                <div class="stat-icon">üë•</div>
                <div class="stat-value">225</div>
                <div class="stat-label">Customers</div>
                <div class="stat-detail">225 active ‚Ä¢ 0 trial</div>
            </div>

            <div class="stat-card area">
                <div class="stat-icon">üìç</div>
                <div class="stat-value">125.3L</div>
                <div class="stat-label">By Area</div>
                <div class="stat-detail">53 areas</div>
            </div>

            <div class="stat-card delivery">
                <div class="stat-icon">üö¥</div>
                <div class="stat-value">125.3L</div>
                <div class="stat-label">By Delivery Boy</div>
                <div class="stat-detail">5 boys</div>
            </div>

            <div class="stat-card marketing">
                <div class="stat-icon">üë§</div>
                <div class="stat-value">125.3L</div>
                <div class="stat-label">By Marketing</div>
                <div class="stat-detail">10 staff</div>
            </div>

            <div class="stat-card nodata">
                <div class="stat-icon">‚ö†Ô∏è</div>
                <div class="stat-value">0</div>
                <div class="stat-label">No Area</div>
            </div>
        </div>

        <!-- Detailed Delivery Stats -->
        <div class="detailed-stats">
            <div class="section-title">üìä Detailed Delivery Stats</div>
            <div class="filters-row">
                <div class="filter-group">
                    <label>üìÖ From Date</label>
                    <input type="date" value="2026-01-23">
                </div>
                <div class="filter-group">
                    <label>üìÖ To Date</label>
                    <input type="date" value="2026-01-23">
                </div>
                <div class="filter-group">
                    <label>‚è±Ô∏è Shift</label>
                    <select>
                        <option>All Shifts</option>
                        <option>Morning</option>
                        <option>Evening</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>üö¥ Delivery Boy</label>
                    <select>
                        <option>All Delivery Boys</option>
                    </select>
                </div>
            </div>
            <button class="apply-filters-btn">Apply Filters</button>
            <div class="no-filters-message">Click "Apply Filters" to see detailed delivery stats</div>
        </div>

        <!-- Tab Navigation -->
        <div class="tab-navigation">
            <button class="tab active" onclick="switchTab('customers', this)">
                Customers (225)
            </button>
            <button class="tab" onclick="switchTab('trial', this)">
                Trial (0)
            </button>
            <button class="tab" onclick="switchTab('addcustomer', this)">
                ‚ûï Add Customer
            </button>
            <button class="tab" onclick="switchTab('products', this)">
                Products
            </button>
            <button class="tab" onclick="switchTab('areas', this)">
                Areas
            </button>
            <button class="tab" onclick="switchTab('deliverylist', this)">
                Delivery List
            </button>
            <button class="tab" onclick="switchTab('exportexcel', this)">
                Export Excel
            </button>
            <button class="tab" onclick="switchTab('import', this)">
                Import
            </button>
            <button class="tab" onclick="switchTab('usermgmt', this)">
                User Management
            </button>
            <button class="tab" onclick="switchTab('deleted', this)">
                Deleted (0)
            </button>
            <button class="tab" onclick="switchTab('pending', this)">
                Pending Requests <span class="tab-badge">1</span>
            </button>
        </div>

        <!-- Content Sections -->
        <div class="content-section" id="customers-section">
            <div class="section-header">
                <h2>Customers</h2>
                <button class="export-btn">üì• Export CSV</button>
            </div>
            <table>
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Email</th>
                        <th>Phone</th>
                        <th>Area</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody id="customersTable">
                    <tr>
                        <td colspan="5" style="text-align: center; color: #95a5a6;">No customers data</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="content-section hidden" id="import-section">
            <div class="import-container">
                <div class="import-box">
                    <h3>üì• Import Data</h3>
                    <p style="color: #7f8c8d; margin: 15px 0; font-size: 13px;">
                        Upload Excel or CSV file to import customers, orders, deliveries, and more
                    </p>
                    <label class="import-label">
                        <input type="file" id="importFile" accept=".xlsx,.csv" onchange="handleImportFileSelect(event)">
                        <button class="import-button" onclick="document.getElementById('importFile').click()">
                            Choose File
                        </button>
                    </label>
                    <div id="importStatus"></div>
                    <div id="importResults"></div>
                </div>

                <div style="margin-top: 30px; padding-top: 20px; border-top: 1px solid #e1e8ed;">
                    <h3 style="margin-bottom: 15px;">Available Templates</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                        <button class="export-btn" onclick="downloadTemplate('customers')">üìã Customer Template</button>
                        <button class="export-btn" onclick="downloadTemplate('orders')">üìã Orders Template</button>
                        <button class="export-btn" onclick="downloadTemplate('delivery')">üìã Delivery Template</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="content-section hidden" id="trial-section">
            <h2>Trial Users</h2>
            <p style="color: #95a5a6; margin-top: 20px;">No trial users at the moment</p>
        </div>

        <div class="content-section hidden" id="products-section">
            <h2>Products</h2>
            <p style="color: #95a5a6; margin-top: 20px;">Products management coming soon</p>
        </div>

        <div class="content-section hidden" id="areas-section">
            <h2>Areas</h2>
            <p style="color: #95a5a6; margin-top: 20px;">Areas management coming soon</p>
        </div>

        <div class="content-section hidden" id="deliverylist-section">
            <h2>Delivery List</h2>
            <p style="color: #95a5a6; margin-top: 20px;">Delivery list coming soon</p>
        </div>

        <div class="content-section hidden" id="exportexcel-section">
            <h2>Export to Excel</h2>
            <button class="export-btn">üìä Export All Data</button>
            <p style="color: #95a5a6; margin-top: 20px;">Click above to export customers and orders</p>
        </div>

        <div class="content-section hidden" id="usermgmt-section">
            <h2>User Management</h2>
            <p style="color: #95a5a6; margin-top: 20px;">User management coming soon</p>
        </div>

        <div class="content-section hidden" id="deleted-section">
            <h2>Deleted Records</h2>
            <p style="color: #95a5a6; margin-top: 20px;">No deleted records</p>
        </div>

        <div class="content-section hidden" id="pending-section">
            <h2>Pending Requests</h2>
            <p style="color: #95a5a6; margin-top: 20px;">1 pending request</p>
        </div>

        <div class="content-section hidden" id="addcustomer-section">
            <h2>Add Customer</h2>
            <form style="max-width: 500px; margin-top: 20px;">
                <div class="filter-group">
                    <label>Name</label>
                    <input type="text" placeholder="Customer name">
                </div>
                <div class="filter-group">
                    <label>Email</label>
                    <input type="email" placeholder="customer@example.com">
                </div>
                <div class="filter-group">
                    <label>Phone</label>
                    <input type="tel" placeholder="10-digit phone number">
                </div>
                <div class="filter-group">
                    <label>Area</label>
                    <input type="text" placeholder="Area name">
                </div>
                <button type="submit" class="apply-filters-btn">Add Customer</button>
            </form>
        </div>
    </div>

    <script>
        // Set today's date
        function setToday() {
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('dashboardDate').value = today;
            updateDateDisplay();
        }

        // Update date display
        function updateDateDisplay() {
            const dateInput = document.getElementById('dashboardDate');
            const dateObj = new Date(dateInput.value);
            const options = { weekday: 'short', year: 'numeric', month: 'short', day: 'numeric' };
            const formatted = dateObj.toLocaleDateString('en-US', options);
            document.getElementById('dateDisplay').textContent = `Showing data for: ${formatted}`;
        }

        document.getElementById('dashboardDate').addEventListener('change', updateDateDisplay);

        // Tab switching
        function switchTab(tabName, button) {
            // Hide all sections
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.add('hidden');
            });

            // Remove active class from all tabs
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });

            // Show selected section
            const sectionId = tabName + '-section';
            const section = document.getElementById(sectionId);
            if (section) {
                section.classList.remove('hidden');
            }

            // Mark tab as active
            if (button) {
                button.classList.add('active');
            }
        }

        // Import functionality
        function handleImportFileSelect(event) {
            const file = event.target.files[0];
            if (!file) return;

            const fileName = file.name;
            const dataType = detectDataTypeFromFileName(fileName);
            
            uploadFileToBackend(file, dataType);
        }

        function detectDataTypeFromFileName(fileName) {
            const lower = fileName.toLowerCase();
            if (lower.includes('customer')) return 'customers';
            if (lower.includes('order')) return 'orders';
            if (lower.includes('delivery')) return 'delivery';
            if (lower.includes('subscription')) return 'subscriptions';
            if (lower.includes('supplier')) return 'suppliers';
            return 'customers'; // default
        }

        async function uploadFileToBackend(file, dataType) {
            const formData = new FormData();
            formData.append('file', file);
            
            try {
                showImportStatus(`‚è≥ Uploading to server...`, 'info');
                
                const authToken = localStorage.getItem('adminToken') || 'demo-token';
                const backendUrl = `http://localhost:9001/api/admin/import/${dataType}`;
                
                const response = await fetch(backendUrl, {
                    method: 'POST',
                    body: formData,
                    headers: {
                        'Authorization': `Bearer ${authToken}`
                    }
                });
                
                const result = await response.json();
                
                if (!response.ok) {
                    showImportStatus(`‚ùå Import Failed: ${result.error || 'Unknown error'}`, 'error');
                    return;
                }
                
                displayImportResults(result);
                
            } catch (error) {
                console.error('Upload error:', error);
                showImportStatus(`‚ùå Connection Error: ${error.message}`, 'error');
            }
        }

        function showImportStatus(message, type) {
            const statusDiv = document.getElementById('importStatus');
            statusDiv.className = `status-message status-${type}`;
            statusDiv.textContent = message;
        }

        function displayImportResults(result) {
            const resultsDiv = document.getElementById('importResults');
            const status = result.status === 'success' ? '‚úÖ' : '‚ùå';
            
            let html = `
                <div class="status-message status-${result.status === 'success' ? 'success' : 'error'}">
                    ${status} Import ${result.status.charAt(0).toUpperCase() + result.status.slice(1)}
                    <br><br>
                    <strong>üìä Summary:</strong><br>
                    Total Records: ${result.total_records}<br>
                    Imported: ${result.imported_records}<br>
                    Failed: ${result.failed_records}
                </div>
            `;
            
            if (result.errors && result.errors.length > 0) {
                html += '<div style="margin-top: 15px;"><strong>‚ö†Ô∏è Errors:</strong><ul>';
                result.errors.forEach(error => {
                    html += `<li style="color: #e74c3c; font-size: 12px;">${error}</li>`;
                });
                html += '</ul></div>';
            }
            
            resultsDiv.innerHTML = html;
        }

        function downloadTemplate(type) {
            // Construct the URL based on type
            const templateMap = {
                'customers': 'EarlyBird_Customer_Import_Template.xlsx',
                'orders': 'EarlyBird_Orders_Import_Template.xlsx',
                'delivery': 'EarlyBird_Delivery_Import_Template.xlsx'
            };
            
            const fileName = templateMap[type];
            const url = `/assets/${fileName}`;
            
            const link = document.createElement('a');
            link.href = url;
            link.download = fileName;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        // ==================== BACKEND DATA LOADING ====================
        
        // Fetch dashboard stats from backend
        async function loadDashboardStats() {
            try {
                // Try to fetch from backend API
                const response = await fetch('http://localhost:9001/api/stats', {
                    headers: { 'Authorization': 'Bearer demo-token' }
                }).catch(() => null);

                if (response && response.ok) {
                    const jsonData = await response.json();
                    const dashboardData = jsonData.data || jsonData;
                    updateStatsCards(dashboardData);
                    console.log('‚úÖ Dashboard stats loaded from backend:', dashboardData);
                } else {
                    // Use localStorage fallback
                    console.warn('Backend unavailable, using localStorage fallback');
                    loadStatsFromLocalStorage();
                }
            } catch (error) {
                console.warn('Backend stats unavailable, using local data:', error);
                loadStatsFromLocalStorage();
            }
        }

        // Load stats from localStorage (fallback)
        function loadStatsFromLocalStorage() {
            try {
                const customers = JSON.parse(localStorage.getItem('earlybird_customers') || '[]');
                const areas = new Set(customers.map(c => c.area)).size;
                const activeCustomers = customers.filter(c => c.status === 'active').length;
                const trialCustomers = customers.filter(c => c.status === 'trial').length;

                // Update stat cards
                document.querySelector('.stat-card.customers .stat-value').textContent = customers.length;
                document.querySelector('.stat-card.customers .stat-detail').textContent = 
                    `${activeCustomers} active ‚Ä¢ ${trialCustomers} trial`;

                document.querySelector('.stat-card.area .stat-value').textContent = areas;
                document.querySelector('.stat-card.area .stat-detail').textContent = `${areas} areas`;

                console.log('‚úÖ Loaded stats from localStorage:', {
                    customers: customers.length,
                    activeCustomers,
                    trialCustomers,
                    areas
                });
            } catch (error) {
                console.error('Error loading stats:', error);
            }
        }

        // Update stat cards with data
        function updateStatsCards(data) {
            console.log('Updating stat cards with:', data);
            
            if (data.customers) {
                const customerElement = document.querySelector('.stat-card.customers .stat-value');
                const detailElement = document.querySelector('.stat-card.customers .stat-detail');
                if (customerElement) customerElement.textContent = data.customers.total;
                if (detailElement) detailElement.textContent = 
                    `${data.customers.active} active ‚Ä¢ ${data.customers.trial} trial`;
            }
            
            if (data.areas) {
                const areaElement = document.querySelector('.stat-card.area .stat-value');
                if (areaElement) areaElement.textContent = data.areas.count;
            }
            
            if (data.delivery) {
                const deliveryElement = document.querySelector('.stat-card.delivery .stat-value');
                if (deliveryElement) deliveryElement.textContent = data.delivery.count;
            }
            
            if (data.marketing) {
                const marketingElement = document.querySelector('.stat-card.marketing .stat-value');
                if (marketingElement) marketingElement.textContent = data.marketing.count;
            }
            
            // Update pending badge if available
            const pendingBadge = document.querySelector('.pending-badge');
            if (pendingBadge && data.pending) {
                pendingBadge.textContent = data.pending.count || 0;
            }
        }

        // Load customers list
        async function loadCustomersList() {
            try {
                // Try backend first
                const response = await fetch('http://localhost:9001/api/customers', {
                    headers: { 'Authorization': 'Bearer demo-token' }
                }).catch(() => null);

                let customers = [];

                if (response && response.ok) {
                    const data = await response.json();
                    customers = data.data || data.customers || [];
                } else {
                    // Fallback to localStorage
                    customers = JSON.parse(localStorage.getItem('earlybird_customers') || '[]');
                }

                // Display customers
                const table = document.getElementById('customersTable');
                if (customers.length === 0) {
                    table.innerHTML = '<tr><td colspan="5" style="text-align: center; color: #95a5a6;">No customers data</td></tr>';
                } else {
                    table.innerHTML = customers.slice(0, 50).map(customer => `
                        <tr>
                            <td>${customer.name || 'N/A'}</td>
                            <td>${customer.email || 'N/A'}</td>
                            <td>${customer.phone || 'N/A'}</td>
                            <td>${customer.area || 'N/A'}</td>
                            <td><span style="color: ${customer.status === 'active' ? '#27ae60' : '#95a5a6'};">${customer.status || 'N/A'}</span></td>
                        </tr>
                    `).join('');
                }

                console.log('‚úÖ Loaded customers:', customers.length);
            } catch (error) {
                console.error('Error loading customers:', error);
            }
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            setToday();
            
            // Load data from backend/localStorage
            loadDashboardStats();
            loadCustomersList();
            
            console.log('‚úÖ Admin Dashboard initialized');
            console.log('üì° Backend URL: http://localhost:9001');
            console.log('üíæ Fallback: localStorage data');
        });
    </script>
</body>
</html>
